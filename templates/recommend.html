<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>NextOnNetflix â€“ Movie Details</title>

  <!-- GoogleÂ Fonts -->
  <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap" rel="stylesheet" />

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />

  <!-- Bootstrap -->
  <link
    rel="stylesheet"
    href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
    crossorigin="anonymous"
  />

  <!-- Custom style -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
</head>

<body id="content" class="recommend" style="font-family:'Noto Sans JP', sans-serif;">
  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Hero Section â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div class="hero-inner container py-4">
    <div class="d-flex flex-wrap gap-4">
      <!-- Poster -->
      <img src="{{ poster }}" alt="{{ title }} poster" class="simple-poster img-fluid rounded shadow" />

      <!-- Details -->
      <div class="hero-details text-white">
        <h2 class="movie-title">{{ title }}</h2>
        <p class="overview mb-3">{{ overview }}</p>

        <ul class="meta list-unstyled mb-0">
          <li><strong>Rating:</strong> {{ vote_average }}/10 ({{ vote_count }} votes)</li>
          <li><strong>Genre:</strong> {{ genres }}</li>
          <li><strong>Release:</strong> {{ release_date }}</li>
          <li><strong>Runtime:</strong> {{ runtime }}</li>
          <li><strong>Status:</strong> {{ status }}</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Cast Modals â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  {% for name, details in cast_details.items() if not cast_details.hidden %}
  <div class="modal fade" id="{{ details[0] }}" tabindex="-1" role="dialog" aria-labelledby="castModalLabel{{ loop.index }}" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header" style="background-color:#e50914;color:#fff;">
          <h5 class="modal-title" id="castModalLabel{{ loop.index }}">{{ name }}</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true" style="color:#fff">&times;</span>
          </button>
        </div>
        <div class="modal-body d-block d-lg-flex">
          <img class="profile-pic mb-3 mb-lg-0" src="{{ details[1] }}" alt="{{ name }} profile" style="width:250px;height:400px;border-radius:10px;" />
          <div class="ml-lg-3">
            <p><strong>Birthday:</strong> {{ details[2] }}</p>
            <p><strong>Place of Birth:</strong> {{ details[3] }}</p>
            <p><strong>Biography:</strong></p>
            <p>{{ details[4] }}</p>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
  {% endfor %}

  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Cast Grid â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  {% if casts|length > 1 %}
  <section class="container movie my-4" style="color:#E8E8E8;">
    <h3 class="text-center">ACTORS &amp; ACTRESSES</h3>
    <h5 class="text-center mb-3">(Click on the cast to know more)</h5>

    <div class="movie-content d-flex flex-wrap justify-content-around">
      {% for name, details in casts.items() if not casts.hidden %}
      <div class="castcard card mb-4" style="width:15rem;" title="Click to know more about {{ name }}" data-toggle="modal" data-target="#{{ details[0] }}">
        <div class="imghvr position-relative">
          <img class="card-img-top cast-img" src="{{ details[2] }}" alt="{{ name }} profile" height="360" width="240" />
          <figcaption class="fig d-flex justify-content-center align-items-center position-absolute w-100 h-100" style="top:0;left:0;">
            <button class="card-btn btn btn-danger">Know&nbsp;More</button>
          </figcaption>
        </div>
        <div class="card-body p-2 text-center">
          <h5 class="card-title mb-1">{{ name|title }}</h5>
          <h6 class="text-muted">Character: {{ details[1]|title }}</h6>
        </div>
      </div>
      {% endfor %}
    </div>
  </section>
  {% endif %}

  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Reviews Table â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  {% if reviews %}
  <section class="container my-4">
    <h2 class="text-center text-white mb-3">USER REVIEWS</h2>
    <div class="table-responsive">
      <table class="table table-bordered text-white" bordercolor="white">
        <thead>
          <tr>
            <th class="text-center" style="width:75%;">Reviews</th>
            <th class="text-center">Status</th>
          </tr>
        </thead>
        <tbody>
          {% for review, status in reviews.items() if not reviews.hidden %}
          <tr style="background-color:#e5091485;">
            <td>{{ review }}</td>
            <td class="text-center">
              {{ status }} :
              {% if status == 'Good' %}&#128515;{% else %}&#128534;{% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </section>
  {% endif %}

  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Recommended Movies â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  {% if movie_cards|length > 1 %}
  <section class="container movie my-4" style="color:#E8E8E8;">
    <h3 class="text-center">RECOMMENDED MOVIES FOR YOU</h3>
    <h5 class="text-center mb-3">(Click any of the movies to get recommendation)</h5>

    <div class="movie-content d-flex flex-wrap justify-content-around">
      {% for poster, title in movie_cards.items() if not movie_cards.hidden %}
      <div class="card mb-4" style="width:15rem;" title="{{ title }}" onclick="recommendcard(this)">
        <div class="imghvr position-relative">
          <img class="card-img-top" src="{{ poster }}" alt="{{ title }} poster" height="360" width="240" />
          <figcaption class="fig d-flex justify-content-center align-items-center position-absolute w-100 h-100" style="top:0;left:0;">
            <button class="card-btn btn btn-danger">View</button>
          </figcaption>
        </div>
        <div class="card-body p-2 text-center">
          <h5 class="card-title mb-1">{{ title|capitalize }}</h5>
        </div>
      </div>
      {% endfor %}
    </div>
  </section>
  {% endif %}

  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <footer class="footer text-right text-white pr-4 pb-2">
    Made&nbsp;for&nbsp;movieâ€‘lovers&nbsp;ðŸŽ¬
  </footer>

  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Scripts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  <script src="{{ url_for('static', filename='recommend.js') }}"></script>

  <!-- Fallback: define recommendcard if recommend.js hasn't done so -->
  <script>
    if (typeof window.recommendcard !== 'function') {
      window.recommendcard = function (elem) {
        const movieTitle = (elem.getAttribute('title') || '').trim() ||
          (elem.querySelector('.card-title') ? elem.querySelector('.card-title').textContent.trim() : '');
        if (!movieTitle) return;
        const $input = $('#autoComplete');
        const $button = $('.movie-button');
        $input.val(movieTitle);
        $button.prop('disabled', false);
        $button.click();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      };
    }
  </script>
</body>
</html>
